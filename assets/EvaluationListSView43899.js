import{o as D,V as k,z as F,f as T,a as A,q as r,A as M,g as B,W as U,_ as z,r as _,E as N,h as w,i as E,j as i,w as u,k as v,l as x,x as S,H as R,J as P,D as j,u as O,T as q,U as H}from"../index43899.js";const L={setup(){D(()=>{l.value=!0,n.value={first:0,page:0,rows:f.value.rows,sortField:null,sortOrder:null,filters:a.value},h()});const d=k(),o=F(),c=T(()=>d.responseEvaluations),t=T(()=>d.evaluationTypes),p=A(),f=r(),m=r(),a=r({cf:{value:"",matchMode:"eq"}}),l=r(!0),n=r(),b=r(0),e=r([{label:"Attivo",value:"true"},{label:"Disattivo",value:"false"}]),y=r([{label:"Utente",value:"evaluation"},{label:"Admin",value:"admin"}]),g=r([{label:"My Filter",value:"myfilter"}]);function h(){l.value=!0;let s=new Map;s=M(a,s),s.set("page",n.value.page+1),s.set("per_page",n.value.rows),n.value.sortField&&(n.value.sortOrder==1?s.set("sorted_by",n.value.sortField+"_asc"):s.set("sorted_by",n.value.sortField+"_desc")),setTimeout(()=>{C(s)},Math.random()*1e3+250)}const C=async function(s){await d.fetchAllEvaluations(s).then(()=>{l.value=!1}).catch(V=>{l.value=!1,B(p,V)})};return{dt:f,responseEvaluations:c,filters:a,loading:l,totalRecords:b,lazyParams:n,matchModes:g,status:e,roles:y,currentEvaluation:m,evaluationTypes:t,onPage:s=>{n.value=s,h()},onSort:s=>{n.value=s,h()},onFilter:()=>{n.value.page=0,n.value.filters=a.value,h()},showSidebar:function(s){o.setDetailType("evaluationS",!1,"Dettaglio valutazione",null,!1,!1,s),o.updateSidebar(!0)},loadLazyData:h,formatDataAndHourFromUnixTimestamps:U}},components:{}};const $={class:"flex justify-content-between align-items-center"},I={class:"p-input-icon-left w-full mr-3 py-2"},G=v("i",{class:"pi pi-search"},null,-1),J=v("div",{class:"flex justify-content-center w-full"},"Semaforo",-1);function K(d,o,c,t,p,f){const m=_("InputText"),a=_("Column"),l=_("Button"),n=_("DataTable"),b=N("tooltip");return w(),E("div",null,[i(n,{value:t.responseEvaluations.cqs_evaluations,totalRecords:t.responseEvaluations.total,lazy:!0,paginator:!0,rows:30,filters:t.filters,"onUpdate:filters":o[1]||(o[1]=e=>t.filters=e),ref:"dt",dataKey:"id",loading:t.loading,onPage:o[2]||(o[2]=e=>t.onPage(e)),onSort:o[3]||(o[3]=e=>t.onSort(e)),onFilter:o[4]||(o[4]=e=>t.onFilter()),removableSort:"",stripedRows:""},{header:u(()=>[v("div",$,[v("span",I,[G,i(m,{modelValue:t.filters.cf.value,"onUpdate:modelValue":o[0]||(o[0]=e=>t.filters.cf.value=e),placeholder:"Filtra per codice fiscale",class:"border-none w-full",onChange:t.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:u(()=>[x(" Nessuna richiesta trovata. ")]),default:u(()=>[i(a,{header:"Data e ora",field:"created_at"},{body:u(({data:e})=>[x(S(t.formatDataAndHourFromUnixTimestamps(e==null?void 0:e.created_at)),1)]),_:1}),i(a,{header:"Codice fiscale",ref:"cf",field:"cf"},null,512),i(a,{field:"created_by",header:"Richiedente"},{body:u(({data:e})=>{var y,g;return[x(S((y=e==null?void 0:e.created_by)==null?void 0:y.first_name)+" "+S((g=e==null?void 0:e.created_by)==null?void 0:g.last_name),1)]}),_:1}),i(a,{header:"",class:"text-center"},{header:u(()=>[J]),body:u(({data:e})=>[v("i",{class:R(["pi pi-circle-fill block text-center",{"text-red-600":e.semaforo=="R","text-yellow-50":e.semaforo=="G","text-green-300":e.semaforo=="V"}])},null,2)]),_:1}),i(a,{header:"Valutazione",ref:"valutazioni"},{body:u(({data:e})=>[x(S(e.valutazione),1)]),_:1},512),i(a,{header:"",style:{width:"4rem"}},{body:u(({data:e})=>[P(i(l,{type:"button",onClick:y=>t.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[b,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading"])])}const W=z(L,[["render",K]]),Y={setup(){D(()=>{const a=j.now(),l=a.startOf("week").toFormat("dd"),n=a.endOf("week").toFormat("dd"),b=a.toFormat("MMMM yyyy");t.value=`${l}/${n} ${b}`});const d=O(),o=k(),c=F(),t=r(),p=T(()=>o.getTotalEvaluations),f=T(()=>d.isUserAdmin);return{totalEvaluation:p,weekDate:t,isAdmin:f,sidebarStore:c,showSidebar:function(){c.setDetailType("newEvaluationS",!0,"Nuova valutazione",null),c.updateSidebar(!0),c.setShowDetail(!0)}}},components:{EvaluationsSTable:W}},Q={class:"flex justify-content-between align-items-center"},X={class:""},Z={key:0},ee={key:1};function te(d,o,c,t,p,f){const m=_("Button"),a=_("EvaluationsSTable");return w(),E("div",null,[v("div",Q,[v("h1",X,[t.totalEvaluation==1?(w(),E("span",Z," 1 Valutazione")):(w(),E("span",ee,S(t.totalEvaluation)+" Valutazioni",1))]),t.isAdmin?H("",!0):(w(),q(m,{key:0,label:"Aggiungi valutazione",class:"mb-3",rounded:"",outlined:"",onClick:o[0]||(o[0]=l=>t.showSidebar())}))]),i(a)])}const re=z(Y,[["render",te]]);export{re as default};
