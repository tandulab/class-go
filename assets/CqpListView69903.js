import{T as P,q as E,f as F,a1 as S,o as I,d as z,a as O,r as T,h as v,i as b,k as i,x as _,j as n,w as r,H as K,l as C,a2 as q,a3 as U,$ as B,L as N,M as $,g as j,K as A}from"../index69903.js";const H=P("cqp-store",()=>{const s=E([]),o=E(0),c=F(()=>s.value),a=F(()=>o.value);return{getAllCqpEval:c,getTotalCqpEval:a,fetchCqpEvaluations:async function(u){const l=await S.fetchCqpEvaluations(u);l.old_cqp_evaluations&&(s.value=l.old_cqp_evaluations,o.value=l.total??0)}}});var x=(s=>(s.LIKE="like",s.EQ="eq",s))(x||{});const Q=(s,o)=>{const c=E(!1),a={first:0,page:0,rows:s.rows},w=function(){const t=new Map;return a.filters&&Object.entries(a.filters).forEach(([d,m])=>{m.matchMode===x.LIKE?t.set(d+"_like",m.value):t.set(d+"_eq",m.value)}),t.set("page",a.page+1),t.set("per_page",a.rows),a.sortField&&(a.sortOrder==1?t.set("sorted_by",a.sortField+"_asc"):t.set("sorted_by",a.sortField+"_desc")),t},u=async function(){c.value=!0;const t=w();await new Promise(d=>setTimeout(d,Math.random()*1e3+250)),await o(t),c.value=!1},l=function(t){a.page=0,a.filters=t,u()},k=t=>{a.sortField=t.sortField,a.sortOrder=t.sortOrder,u()},f=t=>{a.rows=t.rows,a.page=t.page,a.first=t.first,u()};return I(()=>{u()}),{isLoading:c,onFilter:l,onSort:k,onPage:f}},R={class:"flex justify-content-between align-items-center"},G={key:0},J={key:1},W={class:"flex flex-row"},X={class:"ml-2"},Y={key:0},Z=["href"],ee=i("i",{class:"pi pi-file-pdf",style:{color:"lightskyblue","font-size":"1.5rem"}},null,-1),te=[ee],ae=["href"],se=i("i",{class:"pi pi-file-pdf",style:{color:"cadetblue","font-size":"1.5rem"}},null,-1),oe=[se],L=30,le=z({__name:"CqpTable",setup(s){const o=H(),c=O(),{onFilter:a,onPage:w,isLoading:u}=Q({rows:L},m),l=E({first_name:{value:"",matchMode:x.LIKE},last_name:{value:"",matchMode:x.LIKE}}),k=F(()=>o.getAllCqpEval),f=F(()=>o.getTotalCqpEval),t=()=>{a(l.value)},d=function(y){switch(y.status){case 1:return"Idoneo";case 2:return"Non idoneo";case 3:return"Da pre-accettare";default:return"Valutazione in corso"}};async function m(y){try{await o.fetchCqpEvaluations(y)}catch(g){j(c,g)}}return(y,g)=>{const D=T("InputText"),p=T("Column"),M=T("DataTable");return v(),b("div",null,[i("div",R,[i("h1",null,[f.value==1?(v(),b("span",G," 1 Valutazione")):(v(),b("span",J,_(f.value)+" Valutazioni",1))])]),n(M,{value:k.value,"total-records":f.value,lazy:!0,paginator:!0,rows:L,filters:l.value,"onUpdate:filters":g[0]||(g[0]=e=>l.value=e),loading:q(u),onFilter:t,onPage:q(w),filterDisplay:"row",removableSort:"",stripedRows:""},{default:r(()=>[n(p,{field:"first_name",header:"Nome",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:r(({filterModel:e,filterCallback:V})=>[n(D,{type:"text",modelValue:e.value,"onUpdate:modelValue":h=>e.value=h,onKeydown:K(h=>V(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:r(({data:e})=>[C(_(e.first_name),1)]),_:1}),n(p,{field:"last_name",header:"Cognome",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:r(({filterModel:e,filterCallback:V})=>[n(D,{type:"text",modelValue:e.value,"onUpdate:modelValue":h=>e.value=h,onKeydown:K(h=>V(),["enter"]),class:"p-column-filter",placeholder:"Filtra per cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:r(({data:e})=>[C(_(e.last_name),1)]),_:1}),n(p,{field:"birthday",header:"Data di nascita"},{body:r(({data:e})=>[C(_(q(U)(e.birthday)),1)]),_:1}),n(p,{field:"birthday",header:"Data di aggiunta"},{body:r(({data:e})=>[C(_(q(B)(e.created_at)),1)]),_:1}),n(p,{field:"status",header:"Status"},{body:r(({data:e})=>[i("div",W,[i("i",{class:N(["pi pi-circle-fill",{"text-green-300":e.status===1,"text-yellow-50":e.status===3,"text-red-600":e.status===2}])},null,2),i("div",X,_(d(e)),1)])]),_:1}),n(p,{header:"PDF"},{body:r(({data:e})=>[e.aws_pdf_5_url&&e.aws_pdf_6_url?(v(),b("div",Y,[i("a",{class:"pr-1",href:e.aws_pdf_5_url,target:"_blank"},te,8,Z),i("a",{class:"pl-1",href:e.aws_pdf_6_url,target:"_blank"},oe,8,ae)])):$("",!0)]),_:1})]),_:1},8,["value","total-records","filters","loading","onPage"])])}}}),re=z({__name:"CqpListView",setup(s){return(o,c)=>(v(),A(le))}});export{re as default};
